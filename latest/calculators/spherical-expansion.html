<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="SOAP Power spectrum" href="soap-power-spectrum.html" /><link rel="prev" title="Implemented calculators" href="index.html" />

    <meta name="generator" content="sphinx-4.0.2, furo 2021.10.09"/>
        <title>Spherical expansion - Rascaline 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="/home/runner/work/rascaline/rascaline/docs/static/rascaline.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Rascaline 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Rascaline 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Core concepts</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Implemented calculators</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Spherical expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="soap-power-spectrum.html">SOAP Power spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="sorted-distances.html">Sorted distance vector</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">User guide and tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/descriptor.html">What’s in a descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/computing-soap.html">Computing SOAP features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/profiling.html">Profiling calculation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/python/index.html">Python API reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/python/systems.html">Available system implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python/calculators.html">Available Calculators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python/descriptor.html">Descriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python/misc.html">Miscelaneous</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/cxx/index.html">C++ API reference</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/cxx/systems.html">Defining systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cxx/calculators.html">Dealing with calculators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cxx/descriptor.html">Dealing with descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cxx/misc.html">Miscelaneous</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/c/index.html">C API reference</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/c/systems.html">Defining systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/c/calculators.html">Dealing with calculators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/c/descriptor.html">Dealing with descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/c/misc.html">Miscelaneous</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/rust.html">Rust API reference</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../devdoc/index.html">Developer documentation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/getting-started.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/contributing.html">Contribution guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/new-calculator.html">Tutorial: Adding a new calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/architecture.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/interfaces.html">Python and C interface</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="spherical-expansion">
<span id="id1"></span><h1>Spherical expansion<a class="headerlink" href="#spherical-expansion" title="Permalink to this headline">¶</a></h1>
<p>This calculator is registered with the <code class="docutils literal notranslate"><span class="pre">spherical_expansion</span></code> name.</p>
<div class="section" id="json-schema-sphericalexpansion-hyper-parameters">
<h2>SphericalExpansion hyper-parameters<a class="headerlink" href="#json-schema-sphericalexpansion-hyper-parameters" title="Permalink to this headline">¶</a></h2>
<details><summary><a>Show full JSON schema</a></summary><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"$schema"</span><span class="p">:</span> <span class="s2">"http://json-schema.org/draft-07/schema#"</span><span class="p">,</span>
  <span class="s2">"title"</span><span class="p">:</span> <span class="s2">"SphericalExpansionParameters"</span><span class="p">,</span>
  <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Parameters for spherical expansion calculator.</span><span class="se">\n\n</span><span class="s2">The spherical expansion is at the core of representations in the SOAP (Smooth Overlap of Atomic Positions) family. See [this review article](https://doi.org/10.1063/1.5090481) for more information on the SOAP representation, and [this paper](https://doi.org/10.1063/5.0044689) for information on how it is implemented in rascaline."</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
  <span class="s2">"required"</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">"atomic_gaussian_width"</span><span class="p">,</span>
    <span class="s2">"cutoff"</span><span class="p">,</span>
    <span class="s2">"cutoff_function"</span><span class="p">,</span>
    <span class="s2">"gradients"</span><span class="p">,</span>
    <span class="s2">"max_angular"</span><span class="p">,</span>
    <span class="s2">"max_radial"</span><span class="p">,</span>
    <span class="s2">"radial_basis"</span>
  <span class="p">],</span>
  <span class="s2">"properties"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"atomic_gaussian_width"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Width of the atom-centered gaussian used to create the atomic density"</span><span class="p">,</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"number"</span><span class="p">,</span>
      <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"double"</span>
    <span class="p">},</span>
    <span class="s2">"cutoff"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Spherical cutoff to use for atomic environments"</span><span class="p">,</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"number"</span><span class="p">,</span>
      <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"double"</span>
    <span class="p">},</span>
    <span class="s2">"cutoff_function"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Cutoff function used to smooth the behavior around the cutoff radius"</span><span class="p">,</span>
      <span class="s2">"allOf"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">"$ref"</span><span class="p">:</span> <span class="s2">"#/definitions/CutoffFunction"</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"gradients"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Should we also compute gradients of the feature?"</span><span class="p">,</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"boolean"</span>
    <span class="p">},</span>
    <span class="s2">"max_angular"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Number of spherical harmonics to use in the expansion"</span><span class="p">,</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"integer"</span><span class="p">,</span>
      <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"uint"</span><span class="p">,</span>
      <span class="s2">"minimum"</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="p">},</span>
    <span class="s2">"max_radial"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Number of radial basis function to use in the expansion"</span><span class="p">,</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"integer"</span><span class="p">,</span>
      <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"uint"</span><span class="p">,</span>
      <span class="s2">"minimum"</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="p">},</span>
    <span class="s2">"radial_basis"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Radial basis to use for the radial integral"</span><span class="p">,</span>
      <span class="s2">"allOf"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">"$ref"</span><span class="p">:</span> <span class="s2">"#/definitions/RadialBasis"</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">"definitions"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"CutoffFunction"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Possible values for the smoothing cutoff function"</span><span class="p">,</span>
      <span class="s2">"oneOf"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Step function, 1 if `r &lt; cutoff` and 0 if `r &gt;= cutoff`"</span><span class="p">,</span>
          <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
          <span class="s2">"required"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"Step"</span>
          <span class="p">],</span>
          <span class="s2">"properties"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"Step"</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">"additionalProperties"</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Shifted cosine switching function `f(r) = 1/2 * (1 + cos(π (r - cutoff + width) / width ))`"</span><span class="p">,</span>
          <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
          <span class="s2">"required"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"ShiftedCosine"</span>
          <span class="p">],</span>
          <span class="s2">"properties"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"ShiftedCosine"</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
              <span class="s2">"required"</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">"width"</span>
              <span class="p">],</span>
              <span class="s2">"properties"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">"width"</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"number"</span><span class="p">,</span>
                  <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"double"</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">"additionalProperties"</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"RadialBasis"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Radial basis that can be used in the spherical expansion"</span><span class="p">,</span>
      <span class="s2">"oneOf"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Use a radial basis similar to Gaussian-Type Orbitals.</span><span class="se">\n\n</span><span class="s2">The basis is defined as `R_n(r) ∝ r^n e^{- r^2 / (2 σ_n^2)}`, where `σ_n = cutoff * </span><span class="se">\\</span><span class="s2">sqrt</span><span class="si">{n}</span><span class="s2"> / n_max`"</span><span class="p">,</span>
          <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
          <span class="s2">"required"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"Gto"</span>
          <span class="p">],</span>
          <span class="s2">"properties"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"Gto"</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">"additionalProperties"</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Splined version of the `Gto` radial basis.</span><span class="se">\n\n</span><span class="s2">This computes the same integral as the GTO radial basis but using Cubic Hermit splines with control points sampled from the GTO implementation. Using splines is usually much faster (up to 30</span><span class="si">% o</span><span class="s2">f the runtime in the spherical expansion) than using the base GTO implementation.</span><span class="se">\n\n</span><span class="s2">The number of control points in the spline is automatically determined to ensure the maximal absolute error is close to the requested accuracy."</span><span class="p">,</span>
          <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
          <span class="s2">"required"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"SplinedGto"</span>
          <span class="p">],</span>
          <span class="s2">"properties"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"SplinedGto"</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
              <span class="s2">"required"</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">"accuracy"</span>
              <span class="p">],</span>
              <span class="s2">"properties"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">"accuracy"</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"number"</span><span class="p">,</span>
                  <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"double"</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">"additionalProperties"</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</details><p>Parameters for spherical expansion calculator.</p>
<p>The spherical expansion is at the core of representations in the SOAP (Smooth Overlap of Atomic Positions) family. See <a class="reference external" href="https://doi.org/10.1063/1.5090481">this review article</a> for more information on the SOAP representation, and <a class="reference external" href="https://doi.org/10.1063/5.0044689">this paper</a> for information on how it is implemented in rascaline.</p>
<dl class="field-list simple">
<dt>atomic_gaussian_width: <code class="docutils literal notranslate"><span class="pre">number</span></code></dt>
<dd><p>Width of the atom-centered gaussian used to create the atomic density</p>
</dd>
<dt>cutoff: <code class="docutils literal notranslate"><span class="pre">number</span></code></dt>
<dd><p>Spherical cutoff to use for atomic environments</p>
</dd>
<dt>cutoff_function: <a class="reference internal" href="#json-schema-cutofffunction">CutoffFunction</a></dt>
<dd><p>Cutoff function used to smooth the behavior around the cutoff radius</p>
</dd>
<dt>gradients: <code class="docutils literal notranslate"><span class="pre">boolean</span></code></dt>
<dd><p>Should we also compute gradients of the feature?</p>
</dd>
<dt>max_angular: <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">integer</span></code></dt>
<dd><p>Number of spherical harmonics to use in the expansion</p>
</dd>
<dt>max_radial: <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">integer</span></code></dt>
<dd><p>Number of radial basis function to use in the expansion</p>
</dd>
<dt>radial_basis: <a class="reference internal" href="#json-schema-radialbasis">RadialBasis</a></dt>
<dd><p>Radial basis to use for the radial integral</p>
</dd>
</dl>
<div class="section" id="json-schema-cutofffunction">
<h3>CutoffFunction<a class="headerlink" href="#json-schema-cutofffunction" title="Permalink to this headline">¶</a></h3>
<p>Possible values for the smoothing cutoff function</p>
<ul>
<li><span><span>Step: {}</span></span><p>Step function, 1 if <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">&lt;</span> <span class="pre">cutoff</span></code> and 0 if <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">&gt;=</span> <span class="pre">cutoff</span></code></p>
</li>
<li><span><span>ShiftedCosine: {<span>width: number</span>}</span></span><p>Shifted cosine switching function <code class="docutils literal notranslate"><span class="pre">f(r)</span> <span class="pre">=</span> <span class="pre">1/2</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">cos(π</span> <span class="pre">(r</span> <span class="pre">-</span> <span class="pre">cutoff</span> <span class="pre">+</span> <span class="pre">width)</span> <span class="pre">/</span> <span class="pre">width</span> <span class="pre">))</span></code></p>
</li>
</ul>
</div>
<div class="section" id="json-schema-radialbasis">
<h3>RadialBasis<a class="headerlink" href="#json-schema-radialbasis" title="Permalink to this headline">¶</a></h3>
<p>Radial basis that can be used in the spherical expansion</p>
<ul>
<li><span><span>Gto: {}</span></span><p>Use a radial basis similar to Gaussian-Type Orbitals.</p>
<p>The basis is defined as <code class="docutils literal notranslate"><span class="pre">R_n(r)</span> <span class="pre">∝</span> <span class="pre">r^n</span> <span class="pre">e^{-</span> <span class="pre">r^2</span> <span class="pre">/</span> <span class="pre">(2</span> <span class="pre">σ_n^2)}</span></code>, where <code class="docutils literal notranslate"><span class="pre">σ_n</span> <span class="pre">=</span> <span class="pre">cutoff</span> <span class="pre">*</span> <span class="pre">\sqrt{n}</span> <span class="pre">/</span> <span class="pre">n_max</span></code></p>
</li>
<li><span><span>SplinedGto: {<span>accuracy: number</span>}</span></span><p>Splined version of the <code class="docutils literal notranslate"><span class="pre">Gto</span></code> radial basis.</p>
<p>This computes the same integral as the GTO radial basis but using Cubic Hermit splines with control points sampled from the GTO implementation. Using splines is usually much faster (up to 30% of the runtime in the spherical expansion) than using the base GTO implementation.</p>
<p>The number of control points in the spline is automatically determined to ensure the maximal absolute error is close to the requested accuracy.</p>
</li>
</ul>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="soap-power-spectrum.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">SOAP Power spectrum</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Implemented calculators</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Rascaline developers |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="../_sources/calculators/spherical-expansion.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Spherical expansion</a><ul>
<li><a class="reference internal" href="#json-schema-sphericalexpansion-hyper-parameters">SphericalExpansion hyper-parameters</a><ul>
<li><a class="reference internal" href="#json-schema-cutofffunction">CutoffFunction</a></li>
<li><a class="reference internal" href="#json-schema-radialbasis">RadialBasis</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/main.js"></script>
    </body>
</html>